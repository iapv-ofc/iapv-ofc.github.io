<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TESTE - Igreja Palavra e Verdade</title>

    <!-- 1. Tailwind CSS (Para o estilo) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- 2. Swiper.js (Para os carrosséis de Eventos e Fotos) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <!-- 3. Lucide Icons (Para os ícones) -->
    <script src="https://cdn.jsdelivr.net/npm/lucide-react@0.395.0/dist/lucide.min.js"></script>
    <script>
        // Configuração para o Tailwind (para o tema escuro e fontes)
        tailwind.config = {
            darkMode: 'media', // MUDADO: De 'class' para 'media' (automático)
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'], // Fonte bonita, similar à referência
                    },
                    colors: {
                        'accent': '#005DCC', // NOVA: Cor de destaque
                    }
                },
            },
        };
    </script>

    <!-- Estilos personalizados -->
    <style>
        /* Estilo dos cards de evento */
        .event-card {
            /* REMOVIDO: Largura fixa que quebrava o mobile */
            /* width: 330px; */ 
            
            /* NOVO: O card agora ocupa 100% do slide do Swiper */
            width: 100%; 
            
            flex-shrink: 0;
            scroll-snap-align: start;
            /* REMOVIDO: border-color aqui, a sombra agora é mais sutil via Tailwind no JS */
        }
        
        /* MUDADO: Ajuste da sombra das imagens de evento */
        .event-card img {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Sombra mais suave */
        }


        /* Estilo dos botões do Swiper (para combinar com a referência) */
        .swiper-button-next,
        .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 50%;
            width: 44px;
            height: 44px;
            transition: all 0.2s ease-in-out;
        }
        .swiper-button-next:after,
        .swiper-button-prev:after {
            font-size: 20px;
            font-weight: 900;
        }
        .swiper-button-next:hover,
        .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }

        /* Garante que os ícones do Lucide sejam criados */
        .lucide-icon {
            display: inline-block;
            width: 1em;
            height: 1em;
            stroke-width: 2;
            stroke: currentColor;
            fill: none;
        }

        /* Estilo para o Select (Dropdown) - Fica na capa, mantém o visual */
        .custom-select-filter {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            padding: 12px 48px 12px 24px; 
            font-size: 16px;
            font-weight: 600;
            color: #e0e0e0;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            backdrop-filter: blur(10px);
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            width: 100%;
            background-image: none;
        }
        .custom-select-filter:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        .custom-select-filter:focus {
            outline: none;
            ring: 2px;
            ring-color: #005DCC; /* MUDADO: Cor de destaque */
        }
        .custom-select-filter option {
            background-color: #1f2937;
            color: #e0e0e0;
        }

        /* Estilo para as bolinhas do Swiper (Galeria - se fosse usada) */
        .swiper-pagination-bullet {
            background-color: #aaa; /* Cor da bolinha inativa */
            opacity: 0.7;
        }
        .swiper-pagination-bullet-active {
            background-color: #005DCC; /* MUDADO: Cor de destaque */
            opacity: 1;
        }

        /* * =========== ATUALIZAÇÃO DA GALERIA (AQUI!) ===========
         */
        .photo-gallery-card-frame {
            /* REMOVIDO: Largura e altura fixas */
            /* width: 220px; */ 
            /* height: 275px; */

            /* NOVO: Faz o card ocupar 100% do slide */
            width: 100%; 
            
            /* NOVO: Define uma proporção (4:5) para manter o visual de "retrato" */
            aspect-ratio: 4 / 5; 
            
            /* REMOVIDO: background complexo do Uiverse */
            background: none; /* Remove o gradiente colorido */
            border: none; /* Garante que não há borda */
            border-radius: 10px; /* Mantém o arredondamento */
            
            /* MUDADO: Sombra mais suave */
            box-shadow: 0px 4px 10px 0px rgba(0, 0, 0, 0.2); /* Sombra mais sutil */
            
            /* REMOVIDO: Padding, pois não há mais "moldura" */
            padding: 0; 
            
            /* Classes de tema (para a sombra - Tailwind) */
            @apply dark:shadow-black/30; /* Sombra um pouco mais forte no dark mode para contraste */
        }

        .photo-gallery-card-frame img {
            /* Imagem interna */
            width: 100%;
            height: 100%;
            object-fit: cover;
            /* MUDADO: Borda interna levemente arredondada (agora segue o card) */
            border-radius: 10px; /* Arredondamento igual ao do card pai */
            /* REMOVIDO: borda da imagem */
        }
    </style>
</head>

<!-- MUDADO: Classes do body para tema light/dark -->
<body class="bg-gray-50 dark:bg-[#161616] text-gray-900 dark:text-gray-100 antialiased">

    <!-- ===== SEÇÃO 1: CAPA E FILTRO GLOBAL ===== -->
    <header class="h-screen min-h-[600px] w-full flex flex-col items-center justify-center relative bg-cover bg-center bg-no-repeat" style="background-image: url('https://placehold.co/1920x1080/1a202c/7f8c9a?text=Foto+da+Igreja');">
        <!-- Overlay escuro para legibilidade -->
        <div class="absolute inset-0 bg-black/60 z-0"></div>

        <div class="relative z-10 flex flex-col items-center text-center px-4">
            <h1 class="text-4xl sm:text-5xl md:text-6xl font-bold text-white shadow-lg">
                Bem vindo(a) á Igreja Palavra e Verdade
            </h1>
            <p class="mt-4 text-xl sm:text-2xl md:text-3xl text-gray-200 font-light shadow-md">
                Uma igreja em célula
            </p>

            <!-- Filtro Global de Unidades (Dropdown) -->
            <div class="mt-12">
                <label for="unit-select-filter" class="text-lg text-white mb-4 block">Selecione sua unidade:</label>
                <!-- MUDADO: w-72 (fixo) para w-full max-w-sm (responsivo) -->
                <!-- Adicionado px-4 para não colar nas bordas do celular, e sm:px-0 para remover em telas maiores -->
                <div class="relative w-full max-w-sm mx-auto px-4 sm:px-0">
                    <!-- O Select -->
                    <select id="unit-select-filter" class="custom-select-filter">
                        <option value="cajuru">CAJURU</option>
                        <option value="ribeiraopreto">RIBEIRÃO PRETO</option>
                        <option value="santarosa">SANTA ROSA DE VITERBO</option>
                        <option value="santoandre">SANTO ANDRÉ</option>
                    </select>
                    <!-- Seta customizada para o Select -->
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-gray-300">
                        <svg class="fill-current h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Conteúdo principal da página -->
    <main class="w-full">

        <!-- ===== SEÇÃO 2: MISSÃO, VISÃO, VALORES ===== -->
        <section id="sobre" class="py-20 px-4 max-w-6xl mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-12 text-center">
                <!-- Missão -->
                <div class="flex flex-col items-center">
                    <i data-lucide="compass" class="lucide-icon w-12 h-12 text-accent mb-4"></i> <!-- MUDADO -->
                    <h3 class="text-2xl font-bold mb-3">Missão</h3>
                    <p class="text-gray-700 dark:text-gray-300 leading-relaxed"> <!-- MUDADO -->
                        Levar a palavra de Deus a todos, vivendo o amor de Cristo e servindo ao próximo com alegria e dedicação.
                    </p>
                </div>

                <!-- Visão -->
                <div class="flex flex-col items-center">
                    <i data-lucide="eye" class="lucide-icon w-12 h-12 text-accent mb-4"></i> <!-- MUDADO -->
                    <h3 class="text-2xl font-bold mb-3">Visão</h3>
                    <p class="text-gray-700 dark:text-gray-300 leading-relaxed"> <!-- MUDADO -->
                        Ser uma igreja relevante e transformadora, que impacta a sociedade através de células que multiplicam discípulos.
                    </p>
                </div>

                <!-- Valores -->
                <div class="flex flex-col items-center">
                    <i data-lucide="gem" class="lucide-icon w-12 h-12 text-accent mb-4"></i> <!-- MUDADO -->
                    <h3 class="text-2xl font-bold mb-3">Valores</h3>
                    <p class="text-gray-700 dark:text-gray-300 leading-relaxed"> <!-- MUDADO -->
                        Comunhão, Adoração, Serviço, Evangelismo e Discipulado. Pilares que sustentam nossa fé e nossas ações.
                    </p>
                </div>
            </div>
        </section>

        <hr class="border-gray-300 dark:border-gray-700/50 max-w-6xl mx-auto" /> <!-- MUDADO -->

        <!-- ===== SEÇÃO 3: EVENTOS ===== -->
        <section id="eventos" class="py-20 px-4 w-full max-w-7xl mx-auto">
            <!-- MUDADO: Título agora é responsivo (md:text-4xl) -->
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-4">Eventos</h2>
            <p class="text-lg text-gray-600 dark:text-gray-400 text-center mb-10"> <!-- MUDADO -->
                Fique por dentro da nossa agenda para a unidade <span id="eventos-unidade" class="font-bold text-accent">Cajuru</span> <!-- MUDADO -->
            </p>

            <!-- Caixa de Pesquisa -->
            <div class="mb-8 max-w-lg mx-auto">
                <!-- MUDADO: Classes de light/dark para o input -->
                <input type="text" id="event-search-box" placeholder="Pesquisar evento..." class="w-full px-4 py-3 rounded-lg bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-accent">
            </div>

            <!-- Carrossel (Swiper.js) -->
            <div class="relative">
                <!-- MUDADO: Adicionado overflow-hidden para garantir que não vaze -->
                <div id="eventos-slider" class="swiper-container overflow-hidden">
                    <div class="swiper-wrapper" id="eventos-wrapper">
                        <!-- Os slides serão injetados aqui pelo JavaScript -->
                    </div>
                </div>
                <!-- Botões de Navegação -->
                <div class="swiper-button-prev -left-4 md:-left-12"></div>
                <div class="swiper-button-next -right-4 md:-right-12"></div>
            </div>

            <!-- Mensagem de "Nenhum resultado" -->
            <p id="eventos-nenhum-resultado" class="text-center text-gray-500 dark:text-gray-400 mt-8 text-lg hidden"> <!-- MUDADO -->
                Nenhum evento encontrado com esse nome.
            </p>
        </section>

        <hr class="border-gray-300 dark:border-gray-700/50 max-w-6xl mx-auto" /> <!-- MUDADO -->

        <!-- ===== SEÇÃO 4: FOTOS ===== -->
        <section id="fotos" class="py-20 px-4 w-full max-w-7xl mx-auto">
            <!-- MUDADO: Título agora é responsivo (md:text-4xl) -->
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-10">Galeria de Fotos</h2>
            <h3 class="text-3xl md:text-4xl font-bold text-center mb-10">Confira momentos especiais.</h3>

            <!-- MUDADO: Carrossel de Fotos agora é um slider de cards -->
            <div class="relative">
                <!-- MUDADO: Agora é APENAS overflow-hidden. Remove o md:overflow-visible -->
                <div id="fotos-slider" class="swiper-container overflow-hidden"> <!-- !overflow-visible é bom para as sombras -->
                    <div class="swiper-wrapper">
                        
                        <!-- 
                         * =========== ATUALIZAÇÃO DO HTML (AQUI!) ===========
                         * Removida a classe "!w-auto" de todos os slides
                         -->
                        <div class="swiper-slide"> <!-- !w-auto REMOVIDO -->
                            <div class="photo-gallery-card-frame">
                                <img src="https://i.ibb.co/qMGGTywr/IMG-8079.jpg" alt="Foto 1">
                            </div>
                        </div>
                        <div class="swiper-slide"> <!-- !w-auto REMOVIDO -->
                            <div class="photo-gallery-card-frame">
                                <img src="https://i.ibb.co/gLgBVJ8W/IMG-1839.jpg" alt="Foto 2">
                            </div>
                        </div>
                        <div class="swiper-slide"> <!-- !w-auto REMOVIDO -->
                            <div class="photo-gallery-card-frame">
                                <img src="https://i.ibb.co/BKCn1r03/IMG-4173.jpg" alt="Foto 3">
                            </div>
                        </div>
                        <div class="swiper-slide"> <!-- !w-auto REMOVIDO -->
                            <div class="photo-gallery-card-frame">
                                <img src="https://placehold.co/400x500/5E35B1/EDE7F6?text=Foto+4" alt="Foto da Igreja 4">
                            </div>
                        </div>
                        <div class="swiper-slide"> <!-- !w-auto REMOVIDO -->
                            <div class="photo-gallery-card-frame">
                                <img src="https://placehold.co/400x500/1f2937/9ca3af?text=Foto+5" alt="Foto da Igreja 5">
                            </div>
                        </div>
                        <div class="swiper-slide"> <!-- !w-auto REMOVIDO -->
                            <div class="photo-gallery-card-frame">
                                <img src="https://i.ibb.co/hFxtcRX5/IMG-2089.jpg" alt="Foto 6">
                            </div>
                        </div>

                    </div>
                    <!-- REMOVIDO: Paginação (bolinhas) -->
                </div>
                <!-- ADICIONADO: Botões de Navegação -->
                <div class="swiper-button-prev -left-4 md:-left-12"></div>
                <div class="swiper-button-next -right-4 md:-right-12"></div>
            </div>

            <!-- Botão do Álbum (Link dinâmico) -->
            <div class="text-center mt-10">
                <!-- MUDADO: Classes do botão para usar a cor de destaque -->
                <a id="fotos-album-link" href="#" target="_blank" class="inline-block bg-accent text-white font-bold py-3 px-8 rounded-lg text-lg transition-transform duration-200 hover:bg-accent/90 hover:scale-105">
                    Ver álbum completo de <span id="fotos-unidade-nome">Cajuru</span>
                </a>
            </div>
        </section>


        <!-- ===== SEÇÃO 5: CONTATO E MAPA ===== -->
        <!-- MUDADO: Fundo do rodapé para light/dark -->
        <footer id="contato" class="py-20 px-4 bg-gray-100 dark:bg-gray-900/50">
            <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-12">
                
                <!-- Coluna Esquerda: Mapa -->
                <div class="h-96 md:h-full min-h-[400px] rounded-lg overflow-hidden">
                    <iframe 
                        id="mapa-iframe"
                        src="" 
                        width="100%" 
                        height="100%" 
                        style="border:0;" 
                        allowfullscreen="" 
                        loading="lazy" 
                        referrerpolicy="no-referrer-when-downgrade">
                    </iframe>
                </div>

                <!-- Coluna Direita: Informações -->
                <div class="flex flex-col justify-center gap-10">
                    
                    <!-- Parte 1: Endereço -->
                    <div class="flex items-start gap-4">
                        <div class="pt-1">
                            <i data-lucide="map-pin" class="lucide-icon w-6 h-6 text-accent"></i> <!-- MUDADO -->
                        </div>
                        <div>
                            <h4 class="text-xl font-bold mb-1">Endereço</h4>
                            <p id="contato-endereco" class="text-lg text-gray-700 dark:text-gray-300">Carregando...</p> <!-- MUDADO -->
                        </div>
                    </div>

                    <!-- Parte 2: Horários -->
                    <div class="flex items-start gap-4">
                        <div class="pt-1">
                            <i data-lucide="clock" class="lucide-icon w-6 h-6 text-accent"></i> <!-- MUDADO -->
                        </div>
                        <div>
                            <h4 class="text-xl font-bold mb-1">Horário dos Cultos</h4>
                            <p id="contato-horarios" class="text-lg text-gray-700 dark:text-gray-300 whitespace-pre-line">Carregando...</p> <!-- MUDADO -->
                        </div>
                    </div>

                    <!-- Parte 3: Redes Sociais -->
                    <div class="flex items-start gap-4">
                        <div class="pt-1">
                            <i data-lucide="heart-handshake" class="lucide-icon w-6 h-6 text-accent"></i> <!-- MUDADO -->
                        </div>
                        <div>
                            <h4 class="text-xl font-bold mb-1">Siga-nos</h4>
                            <div class="flex gap-5 mt-2">
                                <!-- MUDADO: Classes de hover dos ícones -->
                                <a id="social-instagram" href="#" target="_blank" class="text-gray-500 dark:text-gray-400 hover:text-accent transition-colors">
                                    <i data-lucide="instagram" class="lucide-icon w-8 h-8"></i>
                                </a>
                                <a id="social-youtube" href="#" target="_blank" class="text-gray-500 dark:text-gray-400 hover:text-accent transition-colors">
                                    <i data-lucide="youtube" class="lucide-icon w-8 h-8"></i>
                                </a>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </footer>

    </main>

    <!-- ===== JAVASCRIPT PRINCIPAL ===== -->
    <script>
        // --- 1. BASE DE DADOS (Embutida para Teste) ---
        const churchData = {
            "cajuru": {
                "id": "cajuru",
                "name": "Cajuru",
                "address": "R. Dr. Mata, 1230 - Jardim Santa Maria Goretti, Cajuru - SP",
                "times": "Domingo: 18h30\nQuinta-feira: 20h00",
                "mapUrl": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3717.9188596146923!2d-47.3137659!3d-21.274679199999998!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x94b7786d1d2bbda5%3A0x5db85ec94f106d39!2sR.%20Dr.%20Mata%2C%201230%20-%20Jardim%20Santa%20Maria%20Goretti%2C%20Cajuru%20-%20SP%2C%2014240-000!5e0!3m2!1spt-BR!2sbr!4v1763307958832!5m2!1spt-BR!2sbr",
                "albumUrl": "https://photos.app.goo.gl/exemploAlbumCajuru",
                "socials": {
                    "instagram": "https://www.instagram.com/iapv.cajuru?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==",
                    "youtube": "https://youtube.com/iapv_cajuru"
                },
                "events": [
                    { "id": 0, "title": "EVENTO PASSADO (TESTE)", "date": "15/11/2025", "time": "18h00", "location": "Unidade Cajuru", "startDate": "2025-11-15T18:00:00", "endDate": "2025-11-15T20:00:00", "img": "https://placehold.co/400x200/ef4444/fff?text=EVENTO+PASSADO" },
                    { "id": 1, "title": "Culto da Família", "date": "Todos os Domingos", "time": "18h30", "location": "Unidade Cajuru", "startDate": "2025-11-16T18:30:00", "endDate": "2025-11-16T20:00:00", "img": "https://placehold.co/400x200/0284c7/fff?text=Culto+da+Família" },
                    { "id": 2, "title": "Célula de Jovens", "date": "Toda Sexta-feira", "time": "20h00", "location": "Unidade Cajuru", "startDate": "2025-11-21T20:00:00", "endDate": "2025-11-21T21:30:00", "img": "https://placehold.co/400x200/c2410c/fff?text=Célula+Jovens" },
                    { "id": 3, "title": "Noite de Oração", "date": "Toda Quarta-feira", "time": "20h00", "location": "Unidade Cajuru", "startDate": "2025-11-19T20:00:00", "endDate": "2025-11-19T21:00:00", "img": "https://placehold.co/400x200/16a34a/fff?text=Oração" },
                    { "id": 4, "title": "Batismo", "date": "25/12/2025", "time": "10h00", "location": "Unidade Cajuru", "startDate": "2025-12-25T10:00:00", "endDate": "2025-12-25T12:00:00", "img": "https://placehold.co/400x200/6d28d9/fff?text=Batismo" }
                ]
            },
            "ribeiraopreto": {
                "id": "ribeiraopreto",
                "name": "Ribeirão Preto",
                "address": "R. Monte Santo, 455 - Sumarezinho, Ribeirão Preto - SP",
                "times": "Domingo: 18h30\nQuinta-feira: 20h00",
                "mapUrl": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3720.8037817045547!2d-47.84004278877633!3d-21.160205680440967!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x94b9be735151d6f3%3A0x232ecb692c950ec0!2sR.%20Monte%20Santo%2C%20455%20-%20Sumarezinho%2C%20Ribeir%C3%A3o%20Preto%20-%20SP%2C%2014051-270!5e0!3m2!1spt-BR!2sbr!4v1763308022469!5m2!1spt-BR!2sbr",
                "albumUrl": "https://photos.app.goo.gl/foaSEW2m3V44mFQj6",
                "socials": {
                    "instagram": "https://www.instagram.com/iapv.ribeiraopreto?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==",
                    "youtube": "https://youtube.com/iapv_geral"
                },
                "events": [
                    { "id": 5, "title": "Culto de Celebração", "date": "Todo Domingo", "time": "18h30", "location": "Unidade Ribeirão Preto", "startDate": "2025-11-16T18:30:00", "endDate": "2025-11-16T20:00:00", "img": "https://placehold.co/400x200/059669/fff?text=Celebração" },
                    { "id": 6, "title": "Célula Mista", "date": "Toda Terça-feira", "time": "19h30", "location": "Unidade Ribeirão Preto", "startDate": "2025-11-18T19:30:00", "endDate": "2025-11-18T21:00:00", "img": "https://placehold.co/400x200/b45309/fff?text=Célula+Mista" },
                    { "id": 7, "title": "Café com Pastores", "date": "15/12/2025", "time": "09h00", "location": "Unidade Ribeirão Preto", "startDate": "2025-12-15T09:00:00", "endDate": "2025-12-15T10:30:00", "img": "https://placehold.co/400x200/be185d/fff?text=Café" }
                ]
            },
            "santarosa": {
                "id": "santarosa",
                "name": "Santa Rosa de Viterbo",
                "address": "R. Ângelo Sordi, 505 - Santa Rosa de Viterbo, SP",
                "times": "Domingo: 19h00\nQuarta-feira: 19h30",
                "mapUrl": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3712.3876752940737!2d-47.37881828876797!3d-21.492529880193267!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x94b788d14e37fb6b%3A0x815c01291b99bd48!2sR.%20%C3%82ngelo%20Sordi%2C%20505%2C%20Santa%20Rosa%20de%20Viterbo%20-%20SP%2C%2014270-000!5e0!3m2!1spt-BR!2sbr!4v1763307988606!5m2!1spt-BR!2sbr",
                "albumUrl": "https://photos.app.goo.gl/TVtHSetEbgANVNCt8",
                "socials": {
                    "instagram": "https://www.instagram.com/iapv.srv/?utm_source=ig_web_button_share_sheet",
                    "youtube": "https://youtube.com/iapv_geral"
                },
                "events": [
                    { "id": 8, "title": "Culto (Santa Rosa)", "date": "Todo Domingo", "time": "19h00", "location": "Unidade Santa Rosa", "startDate": "2025-11-16T19:00:00", "endDate": "2025-11-16T20:30:00", "img": "https://placehold.co/400x200/1d4ed8/fff?text=Culto+Santa+Rosa" },
                    { "id": 9, "title": "Estudo Bíblico", "date": "Toda Terça-feira", "time": "19h30", "location": "Unidade Santa Rosa", "startDate": "2025-11-18T19:30:00", "endDate": "2025-11-18T21:00:00", "img": "https://placehold.co/400x200/9d174d/fff?text=Estudo" }
                ]
            },
            "santoandre": {
                "id": "santoandre",
                "name": "Santo André",
                "address": "Av. da Paz, 974 - Utinga, Santo André - SP",
                "times": "Domingo: 10h00\nQuarta-feira: 20h00",
                "mapUrl": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3655.486085089794!2d-46.541219288711204!3d-23.622757078669128!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x94ce5d36ef90bdd3%3A0x837ee62116e35569!2sAv.%20da%20Paz%2C%20974%20-%20Utinga%2C%2o%20Andr%C3%A9%20-%20SP%2C%2009220-310!5e0!3m2!1spt-BR!2sbr!4v1763308041456!5m2!1spt-BR!2sbr",
                "albumUrl": "https://photos.app.goo.gl/Ns7QAGbsaR2FJ7Td8",
                "socials": {
                    "instagram": "https://www.instagram.com/iapv.santoandre?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==",
                    "youtube": "https://youtube.com/iapv_geral"
                },
                "events": [
                    { "id": 10, "title": "Culto de Fim de Semana", "date": "Todo Sábado", "time": "19h00", "location": "Unidade Santo André", "startDate": "2025-11-22T19:00:00", "endDate": "2025-11-22T20:30:00", "img": "https://placehold.co/400x200/86198f/fff?text=Culto+Sábado" },
                    { "id": 11, "title": "Vigília", "date": "Toda última Sexta do mês", "time": "22h00", "location": "Unidade Santo André", "startDate": "2025-11-28T22:00:00", "endDate": "2025-11-29T05:00:00", "img": "https://placehold.co/400x200/1e3a8a/fff?text=Vigília" }
                ]
            }
        };

        // --- 2. ESTADO GLOBAL ---
        let currentUnitId = 'cajuru'; // Unidade padrão
        let swiperEventos; // Variável para guardar o slider de eventos
        
        // --- 3. FUNÇÕES DE ATUALIZAÇÃO ---

        /**
         * Função Principal: Atualiza toda a página com base na unidade selecionada.
         */
        function updatePageContent(unitId) {
            // Guarda o ID da unidade selecionada
            currentUnitId = unitId;

            // Pega os dados da unidade selecionada
            const unitData = churchData[unitId];
            if (!unitData) {
                console.error('Dados da unidade não encontrados:', unitId);
                return;
            }

            // Atualiza o <select> (visual)
            document.getElementById('unit-select-filter').value = unitId;

            // Atualiza a Seção de Eventos
            const now = new Date();
            const futureEvents = unitData.events.filter(event => new Date(event.endDate) >= now);
            document.getElementById('eventos-unidade').textContent = unitData.name;
            updateEventSlider(futureEvents, unitData.name); // MODIFICADO: Passa apenas eventos futuros

            // Atualiza a Seção de Fotos (o botão)
            document.getElementById('fotos-unidade-nome').textContent = unitData.name;
            document.getElementById('fotos-album-link').href = unitData.albumUrl;

            // Atualiza a Seção de Contato/Footer
            document.getElementById('mapa-iframe').src = unitData.mapUrl;
            document.getElementById('contato-endereco').textContent = unitData.address;
            document.getElementById('contato-horarios').textContent = unitData.times;
            document.getElementById('social-instagram').href = unitData.socials.instagram;
            document.getElementById('social-youtube').href = unitData.socials.youtube;
            
            // Limpa a caixa de pesquisa
            document.getElementById('event-search-box').value = '';
        }

        /**
         * Cria o HTML para um card de evento.
         */
        function createEventCard(event, unitName) {
            // Define o local: usa o local do evento se existir, senão usa o nome da unidade
            const location = event.location || unitName;
            
            // Gera o link do Google Agenda
            const calendarLink = createGoogleCalendarLink(event, location);

            // Define os SVGs dos ícones para usar com segurança dentro do JS
            const calendarIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon w-4 h-4 inline-block"><path d="M8 2v4"/><path d="M16 2v4"/><rect width="18" height="18" x="3" y="4" rx="2"/><path d="M3 10h18"/></svg>`;
            const mapPinIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon w-4 h-4 inline-block"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>`;

            // MUDADO: Classes para light/dark mode no card, e sombra mais suave
            return `
                <div class="swiper-slide h-auto">
                    <a href="${calendarLink}" target="_blank" rel="noopener noreferrer" class="event-card bg-white dark:bg-gray-800 shadow-md dark:shadow-black/30 rounded-lg overflow-hidden block h-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        <img src="${event.img}" alt="${event.title}" class="w-full h-40 object-cover shadow-sm"> <!-- Sombra leve na imagem -->
                        <div class="p-5 flex flex-col">
                            <h4 class="text-xl font-bold text-gray-900 dark:text-white mb-2">${event.title}</h4>
                            <div class="text-sm text-gray-600 dark:text-gray-400 mb-2 flex items-center">
                                ${calendarIcon}
                                <span class="ml-1.5">${event.date}${event.time ? ` • ${event.time}` : ''}</span>
                            </div>
                            <div class="text-sm text-gray-700 dark:text-gray-300 flex items-center">
                                ${mapPinIcon}
                                <span class="ml-1.5">${location}</span>
                            </div>
                        </div>
                    </a>
                </div>
            `;
        }
        
        /**
         * Atualiza o carrossel de eventos com base nos eventos filtrados.
         */
        function updateEventSlider(eventsToShow, unitName) { // RECEBE O NOME DA UNIDADE
            const wrapper = document.getElementById('eventos-wrapper');
            const noResultsMsg = document.getElementById('eventos-nenhum-resultado');

            if (!eventsToShow || eventsToShow.length === 0) {
                wrapper.innerHTML = ''; // Limpa o slider
                noResultsMsg.classList.remove('hidden'); // Mostra "Nenhum resultado"
            } else {
                // Passa o unitName para o createEventCard
                wrapper.innerHTML = eventsToShow.map(event => createEventCard(event, unitName)).join('');
                noResultsMsg.classList.add('hidden'); // Esconde "Nenhum resultado"
            }

            // Atualiza o Swiper (importante!)
            if (swiperEventos) {
                swiperEventos.update();
                swiperEventos.slideTo(0); // Volta para o primeiro slide
            }
        }
        
        /**
         * Filtra os eventos com base na caixa de pesquisa.
         */
        function filterEventsBySearch() {
            const searchTerm = document.getElementById('event-search-box').value.toLowerCase();
            
            // Garante que os dados já foram carregados
            if (!churchData || !churchData[currentUnitId]) return;

            // MODIFICADO: Filtra por eventos futuros PRIMEIRO
            const now = new Date();
            const allFutureEvents = churchData[currentUnitId].events.filter(event => new Date(event.endDate) >= now);
            const unitName = churchData[currentUnitId].name; // Pega o nome da unidade atual
            
            if (!searchTerm) {
                updateEventSlider(allFutureEvents, unitName); // MODIFICADO: Se a busca está vazia, mostra todos os eventos FUTUROS
                return;
            }
            
            // MODIFICADO: Filtra a partir da lista de eventos futuros
            const filteredEvents = allFutureEvents.filter(event => 
                event.title.toLowerCase().includes(searchTerm)
            );
            
            updateEventSlider(filteredEvents, unitName); // Mostra apenas os eventos filtrados
        }

        /**
         * NOVO: Cria um link do Google Agenda para um evento.
         */
        function createGoogleCalendarLink(event, location) {
            const baseUrl = 'https://www.google.com/calendar/render?action=TEMPLATE';

            // Formata a data para o padrão do Google (YYYYMMDDTHHMMSS)
            // Remove hífens, dois-pontos e milissegundos
            const formatISODate = (isoStr) => isoStr.replace(/-|:|\.\d+/g, '');

            // Garante que as datas existem antes de formatar
            const dates = event.startDate && event.endDate 
                ? `${formatISODate(event.startDate)}/${formatISODate(event.endDate)}`
                : '';

            const text = encodeURIComponent(event.title);
            const details = encodeURIComponent(`Participe conosco do evento "${event.title}" na ${location}.`);
            const loc = encodeURIComponent(location);

            return `${baseUrl}&text=${text}&dates=${dates}&details=${details}&location=${loc}`;
        }

        // --- 4. INICIALIZAÇÃO QUANDO A PÁGINA CARREGA ---
        document.addEventListener('DOMContentLoaded', () => {
            // Esta função inicializa o site
            initializeApp();
        });

        /**
         * Função que inicializa o site
         */
        function initializeApp() {
            // Inicializa os ícones do Lucide
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }

            // Configura o <select> de filtro global
            const unitSelect = document.getElementById('unit-select-filter');
            unitSelect.addEventListener('change', (event) => {
                const unitId = event.target.value;
                updatePageContent(unitId);
            });

            // Configura a caixa de pesquisa de eventos
            document.getElementById('event-search-box').addEventListener('input', filterEventsBySearch);

            // Inicializa o Swiper de EVENTOS
            swiperEventos = new Swiper('#eventos-slider', {
                slidesPerView: 1, // Quantos slides por vez
                spaceBetween: 20,  // Espaço entre eles
                navigation: {
                    nextEl: '.swiper-button-next',
                    prevEl: '.swiper-button-prev',
                },
                // Responsivo: mostra mais slides em telas maiores
                breakpoints: {
                    640: {
                        slidesPerView: 2,
                        spaceBetween: 20,
                    },
                    1024: {
                        slidesPerView: 3,
                        spaceBetween: 30,
                    },
                    1280: {
                        slidesPerView: 4,
                        spaceBetween: 30,
                    }
                }
            });

            // 
            //  =========== ATUALIZAÇÃO DO JAVASCRIPT (AQUI!) ===========
            // 
            new Swiper('#fotos-slider', {
                // NOVO (Requisito 3): Ativa o loop
                loop: true,

                // NOVO (Requisito 2): Ativa o autoplay (passando a cada 3 segundos)
                autoplay: {
                    delay: 3000,
                    disableOnInteraction: false, // Não para o autoplay se o usuário mexer
                },

                spaceBetween: 30,

                // NOVO (Requisito 1): Define quantos slides aparecem
                slidesPerView: 1, // 1 slide em telas pequenas (celular)
                
                // Define breakpoints para telas maiores
                breakpoints: {
                    // A partir de 768px (tablet)
                    768: {
                        slidesPerView: 2, // Mostra 2 slides
                        spaceBetween: 30,
                    },
                    // A partir de 1024px (desktop)
                    1024: {
                        slidesPerView: 3, // Mostra 3 slides (seu pedido)
                        spaceBetween: 30,
                    }
                },
                
                navigation: {
                    nextEl: '#fotos .swiper-button-next', // Escopo para a seção #fotos
                    prevEl: '#fotos .swiper-button-prev',
                },
            });

            // Carrega o conteúdo da unidade padrão (Sede)
            updatePageContent(currentUnitId);
        }
    </script>
</body>
</html>
